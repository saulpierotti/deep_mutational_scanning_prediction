% Saul Pierotti's inner theme
% 03/07/2021

\mode<presentation>

\def\advisor{\@dblarg\beamer@advisor} % copied from the definition of date in beamer
\long\def\beamer@advisor[#1]#2{%
	\def\insertadvisor{#2}%
	\def\beamer@shortadvisor{#1}%
}

\RequirePackage{appendixnumberbeamer}
\RequirePackage{tikz}
\RequirePackage[style=apa, maxcitenames=1]{biblatex}
\RequirePackage{parskip}
\RequirePackage[verbose=silent]{microtype}
\RequirePackage{siunitx}
\sisetup{round-mode=places,exponent-product=\cdot}
\RequirePackage{booktabs}
\RequirePackage{babel}
\RequirePackage{csquotes}

\usetikzlibrary{arrows.meta}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{positioning}
\usetikzlibrary{calc}
\usetikzlibrary{tikzmark}
\usetikzlibrary{mindmap}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{external}
\tikzexternalize[prefix=./tikz/cache/]%
\tikzset{%
>={Latex[width=2mm,length=2mm]},
pi->/.style={->, color=primary_inverse_fg},
base/.style = {text centered, align=center, inner sep=0.2cm, outer sep=0.1cm, line width=0.5, font=\footnotesize, text width=8em},
object/.style = {base, fill=primary_inverse_bg, text=primary_inverse_fg, draw=primary_inverse_fg, rounded corners},
}
\beamertemplatenavigationsymbolsempty%
\setbeamertemplate{itemize item}{\color{black!80}$\blacktriangleright$}
\setbeamertemplate{itemize subitem}{\color{black!80}$-$}
\setbeamertemplate{headline}[default] % remove header bars
\setbeamertemplate{title page}{%
	\vspace*{-1pt}%
	\hspace*{-\beamer@leftmargin}%
	\tikzset{external/export next=false}%
	\begin{tikzpicture}
		\useasboundingbox (current page.north west) rectangle (current page.south east);
		\fill [color=primary_bg] (current page.north west) rectangle (current page.east);
		%\fill [color=blue] (\beamer@leftmargin,\footskip-1pt) rectangle (\textwidth+\beamer@leftmargin, \textheight+\footskip-1pt);
		\node (titlebox) [
			text width=\textwidth,
			align=left,
			anchor=south west,
			text=white,
			inner sep=0pt,
			outer sep=0pt,
			yshift=1em,
		] at (\beamer@leftmargin,.5\textheight+.5\footskip-.5pt+1.5em) {%
			\large\inserttitle\par%
			\vspace{2em}
			\small\insertsubtitle\par%
		};
		\node (authorbox) [
			text width=\textwidth,
			align=left,
			anchor=north west,
			inner sep=0pt,
			outer sep=0pt,
			yshift=-1em
		] at (\beamer@leftmargin,.5\textheight+.5\footskip-.5pt-1.5em) {%
			\normalsize\insertauthor\par\vspace{2em}%
			\footnotesize\insertadvisor\par%
		};
		\node (datebox) [
			align=right,
			anchor=south east,
			inner sep=0pt,
			outer sep=0pt,
		] at (\beamer@leftmargin+\textwidth,\footskip-1pt) {%
			\normalsize\insertdate\par%
		};
	\end{tikzpicture}%
}%
% this is to silence the overfull hbox due to the background
\let\oldtitlepage\titlepage%
\renewcommand{\titlepage}{\tikzset{external/export next=false}\hfuzz=10pt\oldtitlepage}%

\setbeamertemplate{bibliography item}{}

% silece the font warning for missing small caps sans serif in bibliography acronyms
% not needed for APA but for authoryear
\let\oldmkbibacro\mkbibacro%
\renewcommand{\mkbibacro}[1]{\textrm{\oldmkbibacro{#1}}}%

\mode<all>

% Saul Pierotti's customized theme for the Univeristy of Bologna
% 29/06/2021

\mode<presentation>

\useoutertheme{infolines}
%\setbeamersize{text margin left=1em,text margin right=1em}

\definecolor{bologna_red}{rgb}{0.73333333333, 0.18039215686, 0.16078431372}
\colorlet{primary_bg}{bologna_red}
\colorlet{primary_ligth_bg}{primary_bg!80}
\colorlet{primary_very_ligth_bg}{primary_bg!60}
\colorlet{primary_fg}{white}
\colorlet{primary_inverse_bg}{primary_bg!10}
\colorlet{primary_inverse_fg}{primary_bg!150}
\colorlet{primary_inverse_light_fg}{primary_bg!70}
\colorlet{primary_inverse_dark_bg}{primary_bg!70}
\colorlet{primary_inverse_dark_fg}{primary_bg!200}
\colorlet{primary_accent_bg}{bologna_red!150}
\colorlet{primary_accent_fg}{primary_fg}
\setbeamercolor{author in head/foot}{bg=primary_bg,fg=primary_fg}
\setbeamercolor{title in head/foot}{bg=primary_ligth_bg, fg=primary_fg}
\setbeamercolor{date in head/foot}{bg=primary_very_ligth_bg, fg=primary_fg}
\setbeamercolor{frametitle}{bg=primary_bg,fg=primary_fg}

\def\advisor{\@dblarg\beamer@advisor} % copied from the definition of date in beamer
\long\def\beamer@advisor[#1]#2{%
	\def\insertadvisor{#2}%
	\def\beamer@shortadvisor{#1}%
}

\RequirePackage{appendixnumberbeamer}
\RequirePackage{tikz}
\RequirePackage[style=authoryear, maxcitenames=1]{biblatex}
\RequirePackage{parskip}
\RequirePackage{microtype}
\RequirePackage{siunitx}
\sisetup{round-mode=places,exponent-product=\cdot}
\RequirePackage{booktabs}
\RequirePackage{fontspec}
\RequirePackage{babel}
\RequirePackage{csquotes}

\usetikzlibrary{arrows.meta}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{positioning}
\usetikzlibrary{calc}
\usetikzlibrary{tikzmark}
\usetikzlibrary{mindmap}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{external}
\tikzexternalize[prefix=./tikz/cache/]%
\tikzset{%
>={Latex[width=2mm,length=2mm]},
pi->/.style={->, color=primary_inverse_fg},
base/.style = {text centered, align=center, inner sep=0.2cm, outer sep=0.1cm, line width=0.5, font=\footnotesize, text width=8em},
object/.style = {base, fill=primary_inverse_bg, text=primary_inverse_fg, draw=primary_inverse_fg, rounded corners},
}
\beamertemplatenavigationsymbolsempty%
\setbeamertemplate{itemize item}{\color{black!80}$\blacktriangleright$}
\setbeamertemplate{itemize subitem}{\color{black!80}$-$}
\setbeamertemplate{headline}[default] % remove header bars
\setbeamertemplate{title page}{%
	\vspace*{-1pt}%
	\hspace*{-\beamer@leftmargin}%
	\tikzset{external/export next=false}%
	\begin{tikzpicture}
		\useasboundingbox (current page.north west) rectangle (current page.south east);
		\fill [color=primary_bg] (current page.north west) rectangle (current page.east);
		%\fill [color=blue] (\beamer@leftmargin,\footskip-1pt) rectangle (\textwidth+\beamer@leftmargin, \textheight+\footskip-1pt);
		\node (titlebox) [
			text width=\textwidth,
			align=left,
			anchor=south west,
			text=white,
			inner sep=0pt,
			outer sep=0pt,
			yshift=1em,
		] at (\beamer@leftmargin,.5\textheight+.5\footskip-.5pt+1.5em) {%
			\large\inserttitle\par%
			\vspace{2em}
			\small\insertsubtitle\par%
		};
		\node (authorbox) [
			text width=\textwidth,
			align=left,
			anchor=north west,
			inner sep=0pt,
			outer sep=0pt,
			yshift=-1em
		] at (\beamer@leftmargin,.5\textheight+.5\footskip-.5pt-1.5em) {%
			\normalsize\insertauthor\par\vspace{2em}%
			\footnotesize\insertadvisor\par%
		};
		\node (datebox) [
			align=right,
			anchor=south east,
			inner sep=0pt,
			outer sep=0pt,
		] at (\beamer@leftmargin+\textwidth,\footskip-1pt) {%
			\normalsize\insertdate\par%
		};
	\end{tikzpicture}%
}%
% this is to silence the overfull hbox due to the background
\let\oldtitlepage\titlepage%
\renewcommand{\titlepage}{\tikzset{external/export next=false}\hfuzz=10pt\oldtitlepage}%

\setbeamertemplate{bibliography item}{}
\setbeamercolor{bibliography entry author}{fg=primary_inverse_fg}
\setbeamercolor{bibliography entry title}{fg=black}
\setbeamercolor{bibliography entry note}{fg=primary_inverse_light_fg}

% silece the font warning for missing small caps sans serif in bibliography acronyms
\let\oldmkbibacro\mkbibacro%
\renewcommand{\mkbibacro}[1]{\textrm{\oldmkbibacro{#1}}}%

\mode<all>

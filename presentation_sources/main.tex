\documentclass[10pt, british]{beamer}
\usetheme{UniBo}

\usefonttheme{professionalfonts} % prevents beamer from overriding fonts
\setmonofont{Fira Code Regular}

\addbibresource{./references.bib}

\title[Single Aminoacid Variants Prediction]{Prediction of the Effect of Single Amino Acid Protein
	Variants\\Using Deep Mutational Scanning Data}
\subtitle[]{University of Bologna --- Master Thesis in Bioinformatics}
\author[Pierotti Saul]{Pierotti Saul}
\advisor[]{%
	\setlength{\tabcolsep}{0pt}%
	\begin{tabular}{llll}
		Internal~ & Advisor:~ & Prof.~ & Pietro Di Lena                       \\
		External~ & Advisor:~ & Prof.~ & Arne Elofsson (Stockholm University)
	\end{tabular}
}
\date{July 19, 2021}

\begin{document}

\begin{frame}[plain]
	\titlepage%
\end{frame}

\begin{frame}
	\frametitle{Deep Mutational Scanning}
	High-throughput technique for obtaining fitness information on a large number of mutations
	\vfill%
	\begin{figure}
		\input{tikz/dms_workflow.tex}
	\end{figure}
\end{frame}

\begin{frame}
	\frametitle{I Considered Only Single Amino Acid Variants}
	\vfill%
	\begin{figure}
		\input{tikz/mutation_illustration.tex}
	\end{figure}
\end{frame}

\begin{frame}
	\frametitle{Some Notable Variant Effect Predictors}
	\begin{figure}
		\input{tikz/variant_effect_predictors.tex}
	\end{figure}
	\vfill%
	Among these predictors only Envision was trained on deep mutational scanning data
\end{frame}

\begin{frame}
	\frametitle{Structure of the Project}
	\begin{figure}
		\input{tikz/project_structure.tex}
	\end{figure}
\end{frame}

\begin{frame}
	\frametitle{I Used the Training Dataset of Envision \parencite{Gray2018}}
	\vfill%
	\centering%
	% for some reason figure fails
	\input{tikz/tikzdevice/presentation_fitness_score_distribution.tex}
	\input{tikz/tikzdevice/presentation_datasets_abundancies.tex}
\end{frame}

\begin{frame}
	\frametitle{Poor Correlation among Experimental Results}
	Two independent deep mutational scanning experiments on Ubiquitin are present in the training dataset.
	Their correlation is low.
	\vfill%
	\centering%
	\input{tikz/tikzdevice/presentation_datasets_correlations.tex}
\end{frame}

\begin{frame}
	\frametitle{The Identities of the Mutated Residues Are Important}
	Mutations from polar residues are less detrimental than other mutations.
	This effect disappears when filtering by relative solvent accessibility (not shown here).
	\vfill%
	\centering%
	\input{tikz/tikzdevice/presentation_mutation_identity.tex}
\end{frame}

\begin{frame}
	\frametitle{Buried Residues Are More Conserved}
	\centering%
	\input{tikz/tikzdevice/presentation_score_dssp_rsa.tex}
\end{frame}

\begin{frame}
	\frametitle{Secondary Structure Is Not Critical}
	\centering%
	\input{tikz/tikzdevice/presentation_score_dssp_q3.tex}
\end{frame}

\begin{frame}
	\frametitle{I Did Not Use Structural Information}
	\begin{figure}
		\input{tikz/features.tex}
	\end{figure}
\end{frame}

\begin{frame}
	\frametitle{Single Protein Models with Naive Testing}
	\begin{columns}[c]
		\begin{column}{.6\textwidth}
			\centering%
			\vspace{1em}
			\input{tikz/tikzdevice/presentation_single_protein_models_naive_test_result_summary.tex}
		\end{column}
		\begin{column}{.4\textwidth}
			\begin{itemize}
				\item Half of the mutations in a protein randomly set aside for testing
				\item Hyperparameters optimized in the remaining half with 5-fold cross-validation
				\item Good results but likely overfitting the testing set
			\end{itemize}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}
	\frametitle{Single Protein Models with Testing by Position}
	\begin{columns}[c]
		\begin{column}{.6\textwidth}
			\centering%
			\vspace{1em}
			\input{tikz/tikzdevice/presentation_single_protein_models_by_position_test_result_summary.tex}
		\end{column}
		\begin{column}{.4\textwidth}
			\begin{itemize}
				\item Half of the mutations in a protein set aside for testing but avoiding mutations in the same protein position to end up in different splits
				\item Hyperparameters optimized in the remaining half with 5-fold cross-validation
				\item Performance more realistic
			\end{itemize}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}
	\frametitle{Leave-One-Protein-Out (LOPO) Models}
	\begin{columns}[c]
		\begin{column}{.6\textwidth}
			\centering%
			\vspace{1em}
			\input{tikz/tikzdevice/presentation_general_models_performance_comparison.tex}
		\end{column}
		\begin{column}{.4\textwidth}
			\begin{itemize}
				\item For the left-out protein, half of the mutations used for testing
				\item Spearman correlation coefficient used for evaluation
				\item Small difference among gradient boosted trees and linear regression
				\item Performances comparable to those of Envision
			\end{itemize}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}
	\frametitle{Discussion}
	\begin{figure}
		\begin{tikzpicture}
			\tikzstyle{every node}=[object, font=\footnotesize]
			\node [object, text width=10em] at (0,0) {How validation and testing are performed is crucial};
			\node [object, text width=14em] at (5,-1) {Performances on par with other predictors can be reached without structural features};
			\node [object, text width=9em] at (1,2) {There is strong variability between datasets};
			\node [object, text width=10em] at (0,4) {Complex models do not improve much on linear regression};
			\node [object, text width=10em] at (6,3) {Unsupervised models perform similarly to supervised models};
		\end{tikzpicture}
	\end{figure}
\end{frame}

\begin{frame}
	\frametitle{Future Directions}
	\begin{figure}
		\begin{tikzpicture}
			\tikzstyle{every node}=[object, font=\footnotesize]
			\node [object, text width=14em] at (0,0) {Using residue contacts in a graph convolutional neural network};
			\node [object, text width=7em] at (1,2) {Tuning the set of features};
			\node [object, text width=10em] at (6,3) {Training on more deep mutational scanning studies};
			\node [object, text width=13em] at (1,4) {Unsupervised models seem promising and may be worth exploring more};
			\node [object, text width=15em] at (6,-1) {Finding a better normalization strategy for the scores from different experiments};
		\end{tikzpicture}
	\end{figure}
\end{frame}

\appendix%
\begin{frame}[allowframebreaks]
	\frametitle{Bibliography}
	\printbibliography{}%
\end{frame}

\begin{frame}
	\frametitle{Supplementary Material}
	Confidence intervals in prediction performances
	\vfill%
	\tiny%
	\begin{tabular*}{\linewidth}{@{\extracolsep{\fill}}llll}%
		\toprule
		Dataset name            & Model       & \SI{95}{\percent} C.I. (Pearson) & \SI{95}{\percent} C.I. (Spearman) \\
		\midrule
		\texttt{beta-lactamase} & Naive       & \numrange{0.8866}{0.9077}        & \numrange{0.8578}{0.8803}         \\
		\texttt{beta-lactamase} & By position & \numrange{0.7927}{0.8272}        & \numrange{0.7461}{0.7820}         \\
		\texttt{beta-lactamase} & LOPO        & ---                              & \numrange{0.6781}{0.7210}         \\
		\texttt{WW\_domain}     & Naive       & \numrange{0.6747}{0.8174}        & \numrange{0.7044}{0.8368}         \\
		\texttt{WW\_domain}     & By position & \numrange{0.5679}{0.7291}        & \numrange{0.5203}{0.7168}         \\
		\texttt{WW\_domain}     & LOPO        & ---                              & \numrange{0.5628}{0.7297}         \\
		\texttt{PSD95pdz3}      & Naive       & \numrange{0.7443}{0.8313}        & \numrange{0.7276}{0.8008}         \\
		\texttt{PSD95pdz3}      & By position & \numrange{0.5487}{0.6652}        & \numrange{0.5442}{0.6485}         \\
		\texttt{PSD95pdz3}      & LOPO        & ---                              & \numrange{0.5335}{0.6282}         \\
		\texttt{kka2\_1:2}      & Naive       & \numrange{0.7405}{0.7763}        & \numrange{0.7232}{0.7588}         \\
		\texttt{kka2\_1:2}      & By position & \numrange{0.6451}{0.6881}        & \numrange{0.6401}{0.6824}         \\
		\texttt{kka2\_1:2}      & LOPO        & ---                              & \numrange{0.5975}{0.6427}         \\
		\texttt{hsp90}          & Naive       & \numrange{0.8190}{0.8664}        & \numrange{0.6522}{0.7071}         \\
		\texttt{hsp90}          & By position & \numrange{0.6945}{0.7577}        & \numrange{0.4996}{0.5674}         \\
		\texttt{hsp90}          & LOPO        & ---                              & \numrange{0.3771}{0.4529}         \\
		\texttt{Ubiquitin}      & Naive       & \numrange{0.7470}{0.8281}        & \numrange{0.7782}{0.8321}         \\
		\texttt{Ubiquitin}      & By position & \numrange{0.4858}{0.6035}        & \numrange{0.4565}{0.5672}         \\
		\texttt{Ubiquitin}      & LOPO        & ---                              & \numrange{0.2951}{0.4296}         \\
		\texttt{Pab1}           & Naive       & \numrange{0.8047}{0.8749}        & \numrange{0.7482}{0.8239}         \\
		\texttt{Pab1}           & By position & \numrange{0.6545}{0.7590}        & \numrange{0.6423}{0.7288}         \\
		\texttt{Pab1}           & LOPO        & ---                              & \numrange{0.6038}{0.7004}         \\
		\texttt{E1\_Ubiquitin}  & Naive       & \numrange{0.7454}{0.8470}        & \numrange{0.6487}{0.7517}         \\
		\texttt{E1\_Ubiquitin}  & By position & \numrange{0.5898}{0.7218}        & \numrange{0.3623}{0.5100}         \\
		\texttt{E1\_Ubiquitin}  & LOPO        & ---                              & \numrange{0.5027}{0.6343}         \\
		\texttt{gb1}            & Naive       & \numrange{0.8965}{0.9341}        & \numrange{0.8759}{0.9194}         \\
		\texttt{gb1}            & By position & \numrange{0.3072}{0.4561}        & \numrange{0.2942}{0.4522}         \\
		\texttt{gb1}            & LOPO        & ---                              & \numrange{0.3225}{0.4706}         \\
		\bottomrule
	\end{tabular*}%
\end{frame}

\begin{frame}
	\frametitle{Supplementary Material}
	Statistical significance of performance differences. Bonferroni-corrected $\alpha = \frac{0.05}{27} = 0.00185185$.
	Starred values are significant.
	\vfill%
	\tiny%
	\begin{tabular*}{\linewidth}{@{\extracolsep{\fill}}lllll}%
		\toprule
		Dataset name            & Model 1           & Model 2                & $p$ value      \\
		\midrule
		\texttt{beta-lactamase} & Linear regression & Gradient boosted trees & \num{1e-4} * \\
		\texttt{beta-lactamase} & Linear regression & EVmutation             & \num{1e-4} * \\
		\texttt{beta-lactamase} & EVmutation        & Gradient boosted trees & \num{1e-4} * \\
		\texttt{WW\_domain}     & Linear regression & Gradient boosted trees & \num{1e-4} * \\
		\texttt{WW\_domain}     & Linear regression & EVmutation             & \num{1e-4} * \\
		\texttt{WW\_domain}     & EVmutation        & Gradient boosted trees & \num{1e-4} * \\
		\texttt{PSD95pdz3}      & Linear regression & Gradient boosted trees & \num{1e-4} * \\
		\texttt{PSD95pdz3}      & Linear regression & EVmutation             & \num{1e-4} * \\
		\texttt{PSD95pdz3}      & EVmutation        & Gradient boosted trees & \num{0.514}  \\
		\texttt{kka2\_1:2}      & Linear regression & Gradient boosted trees & \num{0.0043} \\
		\texttt{kka2\_1:2}      & Linear regression & EVmutation             & \num{0.0053} \\
		\texttt{kka2\_1:2}      & EVmutation        & Gradient boosted trees & \num{1e-4} * \\
		\texttt{hsp90}          & Linear regression & Gradient boosted trees & \num{1e-4} * \\
		\texttt{hsp90}          & Linear regression & EVmutation             & \num{1e-4} * \\
		\texttt{hsp90}          & EVmutation        & Gradient boosted trees & \num{0.2358} \\
		\bottomrule
	\end{tabular*}%
	\normalsize%

	The table continues on the next slide.
\end{frame}

\begin{frame}
	\frametitle{Supplementary Material}
	Statistical significance of performance differences. Bonferroni-corrected $\alpha = \frac{0.05}{27} = 0.00185185$.
	Starred values are significant.

	The table continues from the previous slide.
	\vfill%
	\tiny%
	\begin{tabular*}{\linewidth}{@{\extracolsep{\fill}}lllll}%
		\toprule
		Dataset name            & Model 1           & Model 2                & $p$ value      \\
		\midrule
		\texttt{Ubiquitin}      & Linear regression & Gradient boosted trees & \num{1e-4} * \\
		\texttt{Ubiquitin}      & Linear regression & EVmutation             & \num{1e-4} * \\
		\texttt{Ubiquitin}      & EVmutation        & Gradient boosted trees & \num{1e-4} * \\
		\texttt{Pab1}           & Linear regression & Gradient boosted trees & \num{1e-4} * \\
		\texttt{Pab1}           & Linear regression & EVmutation             & \num{1e-4} * \\
		\texttt{Pab1}           & EVmutation        & Gradient boosted trees & \num{1e-4} * \\
		\texttt{E1\_Ubiquitin}  & Linear regression & Gradient boosted trees & \num{1e-4} * \\
		\texttt{E1\_Ubiquitin}  & Linear regression & EVmutation             & \num{1e-4} * \\
		\texttt{E1\_Ubiquitin}  & EVmutation        & Gradient boosted trees & \num{1e-4} * \\
		\texttt{gb1}            & Linear regression & Gradient boosted trees & \num{1e-4} * \\
		\texttt{gb1}            & Linear regression & EVmutation             & \num{1e-4} * \\
		\texttt{gb1}            & EVmutation        & Gradient boosted trees & \num{1e-4} * \\
		\bottomrule
	\end{tabular*}%
\end{frame}

\end{document}
